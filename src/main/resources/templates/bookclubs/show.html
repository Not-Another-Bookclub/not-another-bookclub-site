<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <head th:include="partials.html::head('A detailed view of this bookclub')">
        <title>Detailed view of this post</title>
    </head>

<link rel="stylesheet" href="/css/show-bookclub.css">

<link rel="stylesheet" href="/css/utils.css">
<script src="/js/magical_library_background_progressive.js"></script>


<html lang="en">


<body>
<div th:replace="partials.html::navbar"></div>




<div class="container">


<!--    INFO / OWNER SECTION-->
    <div id="breadcrumbBookclubs" class="narrow-body mb-3">
        <nav aria-label="breadcrumb" class="breadcrumbs">
            <ul class="breadcrumb">
                <li class="breadcrumb-item">
                    <a th:href="@{/bookclubs}">Bookclubs</a>
                </li>
                <li class="breadcrumb-item" aria-current="page">
                    BookClub
                </li>
            </ul>
        </nav>
    </div>

    <div class="narrow-body pro-card">
        <div class="row d-flex flex-column flex-md-row p-3">
            <div class="col-6">
                <h1 th:text="${bookclub.name}"></h1>
                <p th:text="${bookclub.description}"></p>
                <p>This bookclub is lead by -</p>
                <a th:href="@{/pro/__${bookclub.owner.id}__}" class="butn pro-link mb-2" th:text="${bookclub.owner.username}">View Profile</a>
            </div>
            <div  th:if="${isOwner}" class="col-6 p-3">
<!--                <div class="col-6 p-3">-->
                    <h2>You own this Bookclub</h2>

                    <div class="d-flex">
                        <div th:if="${books.size() > 0}">
                            <a th:href="@{'/bookclubs/' + ${bookclub.id} + '/meeting/create'}" class="butn meeting-link">Make a meeting?</a>
                        </div>
                        <div th:if="${books.size() < 1}">
                            <p>Add Books to this club's reading list to make meetings.</p>
                        </div>
                        <div class="mx-3">
                            <a th:href="@{'/bookclubs/' + ${bookclub.id} + '/edit' }" class="butn boo-link">Edit Club</a>
                        </div>
                    </div>

            </div>

        </div>
<!--        HERE-->

    </div>

    <div th:if="${user.username != null}" class="">
        <div th:if="${isAccepting}">
        <div th:if="${isNotMember}" class="narrow-body pro-card my-3">
<!--            <hr class="acc-bar">-->
            <div>
            <form  class="p-2" th:action="@{'/bookclubs/invite/' + ${bookclub.id}}" th:method="post" th:object="${bookclub}">
                <label for="join-club">Want to join?</label>
                <input type="submit" id="join-club" class="butn pro-link" value="Join">
            </form>
            </div>
        </div>
        <div th:if="${!isAccepting}">
            <hr>
            <div th:if="${isOwner}">
                <form th:if="${isNotMember}" th:action="@{'/bookclubs/invite/' + ${bookclub.id}}" th:method="post" th:object="${bookclub}">
                    <label for="join-club">Want to join?</label>
                    <input type="submit" id="join-club" class="btn btn-danger" value="Join">
                </form>
            </div>

        </div>
        </div>
    </div>

<!--    END OF INFO / OWNER -->

<!--    PEOPLE WHO WANT TO JOIN-->
    <div th:if="${isOwner}" class="narrow-body">
        <details th:if="${pendingUsers.size() > 0}" class="pro-card my-3">
            <summary class="d-flex justify-content-between align-items-center p-3">
                <h2 >Pending Requests</h2>
                <i class="fas fa-angle-down fa-2x"></i>
            </summary>

            <hr class="acc-bar">

            <div  class="hidden-content
                    d-flex
                    align-items-center
                    align-items-md-start
                    flex-column
                    flex-md-row
                    flex-nowrap
                    flex-md-wrap
                    ">
                <div th:each="user : ${pendingUsers}" class="invite-unit d-flex flex-row m-3 p-3 row">
                    <div class="card p-2 m-1 col-12 col-sm-7 text-center">
                        <a class="butn pro-link" th:href="@{'/pro/' + ${user.id} }" th:text="${user.username}"></a>
                        <span> Wants to join</span>
                    </div>
                    <div class="card p-2 m-1 col-12 col-sm-4 text-center d-flex flex-column align-items-center justify-content-evenly">
                        <form th:action="@{'/bookclubs/invite/accept/' + ${bookclub.id} + '/' + ${user.id}}" th:method="post" th:object="${bookclub}">
                            <input type="submit" class="util-butn util-butn-accept" value="Accept ">
                        </form>
                        <form th:action="@{'/bookclubs/invite/decline/' + ${bookclub.id} + '/' + ${user.id}}" th:method="post" th:object="${bookclub}">
                            <input type="submit" class="util-butn util-butn-decline" value="Decline">
                        </form>
                    </div>
                </div>
            </div>
        </details>



    </div>


    <!--    START THE PUBLIC/PRIVATE CONTINGENCY-->
    <div th:if="${!isPrivate}" class="narrow-body">
<!--        MEMBERS-->
        <details th:if="${members.size() > 0}" class="pro-card my-3">
            <summary class="d-flex justify-content-between align-items-center p-3">
                <h2>Current Members</h2>
                <i class="fas fa-angle-down fa-2x"></i>
            </summary>

            <hr class="acc-bar">

            <div class="hidden-content
                    d-flex
                    align-items-center
                    align-items-md-start
                    flex-column
                    flex-md-row
                    flex-nowrap
                    flex-md-wrap
                    p-3">
                <a th:each="member : ${members}" th:href="@{'/pro/' + ${member.id}}" class="butn pro-link pro-link-2 m-2">
                    <span th:text="${member.username}"></span>
                </a>
            </div>

        </details>

<!--        MEETINGS-->
        <div th:if="${isActiveUser}">
            <details th:if="${meetings.size() > 0}" class="pro-card my-3">
                <summary class="d-flex justify-content-between align-items-center p-3">
                    <h2>Meetings</h2>
                    <i class="fas fa-angle-down fa-2x"></i>
                </summary>

                <hr class="acc-bar">

                <div class="hidden-content
                    d-flex
                    align-items-center
                    align-items-md-start
                    flex-column
                    flex-md-row
                    flex-nowrap
                    flex-md-wrap
                    p-3">
                    <a
                            th:href="@{/bookclubs/__${bookclub.id}__/meeting/__${meeting.id}__}"
                            th:each="meeting : ${meetings}"
                            class="butn meeting-link pro-link-2 m-2">
                        <span th:text="${#dates.format(meeting.timedate,'E, MMM dd yyyy HH:mm:ss')}"></span>
                        <!--                <span th:text="${meeting.location}"></span> to discuss-->
                        <!--                <span th:text="${meeting.book.googleID}"></span>-->
                    </a>
                </div>

            </details>

        </div>

<!--        POSTS-->
        <div th:if="${isActiveUser}">
            <div th:if="${posts.size() > 0}" >
                <details class="pro-card my-3">
                    <summary class="d-flex justify-content-between align-items-center p-3">
                        <h2>
                            Posts for <span th:text="${bookclub.name}"></span>:
                        </h2>
                        <i class="fas fa-angle-down fa-2x"></i>
                    </summary>
                    <hr class="acc-bar">
                    <div class="hidden-content
                        d-flex
                        align-items-center
                        align-items-md-start
                        flex-column
                        flex-md-row
                        flex-nowrap
                        flex-md-wrap
                        p-3">
                        <a th:href="@{/bookclubs/__${bookclub.id}__/posts/__${post.id}__}"
                           th:each="post : ${posts}" class="butn post-link m-2">
                            <span th:text="${post.title}"></span> by:
                            <span th:text="${post.author.username}"></span> (There are <span th:text="${post.comments.size()}"></span> comments)
                        </a>
                    </div>
                </details>

            </div>


            <details th:if="${isActiveUser}" class="pro-card">
                <summary class="p-3">
                    Don't see what you're looking for? <a th:href="@{/bookclubs/__${bookclub.id}__/posts/create}" class="butn post-link"> Create your own post</a>
                </summary>
            </details>
        </div>

<!--        BOOKS-->
        <div th:if="${isOwner}">
            <div th:replace="partials.html :: booksearch"></div>
            <br>
            <br>

        </div>

        <div th:if="${books.size() > 0}">
            <h1>
                Here's the books on the <span th:text="${bookclub.name}"></span> reading list.
            </h1>
            <div id="results1" class="row"></div>
            <br>
            <br>
        </div>


    </div>

    <div th:if="${isPrivate}" class="narrow-body">
        <div th:if="${user == null}">
            <h3>I'm sorry this group is Private.</h3>
        </div>
        <div th:if="${user}">
            <div th:if="${isNotMember}">
                <h3>I'm sorry this group is Private.</h3>
            </div>
            <div th:if="${!isNotMember}">
                <div th:if="${isActiveUser}">
                    <!--        MEMBERS-->
                    <details th:if="${members.size() > 0}" class="pro-card my-3">
                        <summary class="d-flex justify-content-between align-items-center p-3">
                            <h2>Current Members</h2>
                            <i class="fas fa-angle-down fa-2x"></i>
                        </summary>

                        <hr class="acc-bar">

                        <div class="hidden-content
                    d-flex
                    align-items-center
                    align-items-md-start
                    flex-column
                    flex-md-row
                    flex-nowrap
                    flex-md-wrap
                    p-3">
                            <a th:each="member : ${members}" th:href="@{'/pro/' + ${member.id}}" class="butn pro-link pro-link-2 m-2">
                                <span th:text="${member.username}"></span>
                            </a>
                        </div>

                    </details>

                    <!--        MEETINGS-->
                    <div >
                        <details th:if="${meetings.size() > 0}" class="pro-card my-3">
                            <summary class="d-flex justify-content-between align-items-center p-3">
                                <h2>Meetings</h2>
                                <i class="fas fa-angle-down fa-2x"></i>
                            </summary>

                            <hr class="acc-bar">

                            <div class="hidden-content
                    d-flex
                    align-items-center
                    align-items-md-start
                    flex-column
                    flex-md-row
                    flex-nowrap
                    flex-md-wrap
                    p-3">
                                <a
                                        th:href="@{/bookclubs/__${bookclub.id}__/meeting/__${meeting.id}__}"
                                        th:each="meeting : ${meetings}"
                                        class="butn meeting-link pro-link-2 m-2">
                                    <span th:text="${#dates.format(meeting.timedate,'E, MMM dd yyyy HH:mm:ss')}"></span>
                                    <!--                <span th:text="${meeting.location}"></span> to discuss-->
                                    <!--                <span th:text="${meeting.book.googleID}"></span>-->
                                </a>
                            </div>

                        </details>

                    </div>

                    <!--        POSTS-->
                    <div th:if="${isActiveUser}">
                        <div th:if="${posts.size() > 0}" >
                            <details class="pro-card my-3">
                                <summary class="d-flex justify-content-between align-items-center p-3">
                                    <h2>
                                        Posts for <span th:text="${bookclub.name}"></span>:
                                    </h2>
                                    <i class="fas fa-angle-down fa-2x"></i>
                                </summary>
                                <hr class="acc-bar">
                                <div class="hidden-content
                        d-flex
                        align-items-center
                        align-items-md-start
                        flex-column
                        flex-md-row
                        flex-nowrap
                        flex-md-wrap
                        p-3">
                                    <a th:href="@{/bookclubs/__${bookclub.id}__/posts/__${post.id}__}"
                                       th:each="post : ${posts}" class="butn post-link m-2">
                                        <span th:text="${post.title}"></span>
                                        <span th:text="${post.author.username}"></span> (There are <span th:text="${post.comments.size()}"></span> comments)
                                    </a>
                                </div>
                            </details>

                        </div>


                        <p th:if="${isActiveUser}">
                            Don't see what you're looking for? <a th:href="@{/bookclubs/__${bookclub.id}__/posts/create}"> Create your own post</a>
                        </p>
                    </div>

                    <!--        BOOKS-->
                    <div th:if="${isOwner}">
                        <div th:replace="partials.html :: booksearch"></div>
                        <br>
                        <br>

                    </div>

                    <div th:if="${books.size() > 0}">
                        <h1>
                            Here's the books on the <span th:text="${bookclub.name}"></span> reading list.
                        </h1>
                        <div id="results1" class="row"></div>
                        <br>
                        <br>
                    </div>
                </div>
                <div th:if="${!isActiveUser}">
                    <div th:if="${isNotActiveUser}">
                        <h3>Pending</h3>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <!--    END OF PUBLIC/PRIVATE CONTINGENCY-->
</div>


<div th:replace="partials.html::bookclubmodal"></div>

<br>
<br>
</div>

<footer th:replace="partials.html::footer"></footer>
<div th:if="${isOwner}">
    <script th:replace="partials.html::booksearchscript('bookclub',${bookclub.id})"></script></div>
<script th:replace="partials.html::bookdisplay(${books})"></script>
</body>
</html>